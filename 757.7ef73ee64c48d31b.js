"use strict";(self.webpackChunkmanage_shop=self.webpackChunkmanage_shop||[]).push([[757],{9757:(Dt,C,i)=>{i.r(C),i.d(C,{OrderModule:()=>Zt});var u=i(6814),_=i(4190),t=i(5879),p=i(3365),m=i(3566),l=i(5313),O=i(5246),s=i(3373),h=function(e){return e.CASH="CASH",e.ONLINE="ONLINE",e}(h||{}),f=i(7700),D=i(6593);let y=(()=>{class e{constructor(n,o){this.data=n,this.sanitizer=o}static#t=this.\u0275fac=function(o){return new(o||e)(t.Y36(f.WI),t.Y36(D.H7))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-map-dialog"]],decls:2,vars:1,consts:[[1,"p-4"],["width","600","height","450","loading","lazy","allowfullscreen","","referrerpolicy","no-referrer-when-downgrade",2,"border","0",3,"src"]],template:function(o,r){1&o&&(t.TgZ(0,"div",0),t._UZ(1,"iframe",1),t.qZA()),2&o&&(t.xp6(1),t.Q6J("src",r.sanitizer.bypassSecurityTrustResourceUrl(r.data.googleMapUrl),t.uOi))}})}return e})();var v=i(3601),A=i(872),N=i(4300),L=i(3942),S=i(4321),T=i(1175),E=i(2296),g=i(4170),x=i(8525),U=i(3680),Z=i(2032);function Y(e,a){1&e&&(t.TgZ(0,"th",36),t._uU(1," M\xe3 "),t.qZA())}function B(e,a){if(1&e&&(t.TgZ(0,"td",37),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.hij(" ",n.key," ")}}function I(e,a){1&e&&(t.TgZ(0,"th",38),t._uU(1," Kh\xe1ch h\xe0ng "),t.qZA())}function M(e,a){if(1&e&&(t.TgZ(0,"td",37),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.hij(" ",n.name," ")}}function b(e,a){1&e&&(t.TgZ(0,"th",36),t._uU(1," S\u0110T "),t.qZA())}function k(e,a){if(1&e&&(t.TgZ(0,"td",37),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.hij(" ",n.phoneNumber," ")}}function w(e,a){1&e&&(t.TgZ(0,"th",36),t._uU(1," \u0110\u1ecba ch\u1ec9 "),t.qZA())}function Q(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"td",39)(1,"a",40),t.NdJ("click",function(){const c=t.CHM(n).$implicit,d=t.oxw();return t.KtG(d.openGoogleMapDialog(c.address))}),t._uU(2),t.qZA()()}if(2&e){const n=a.$implicit;t.s9C("title",n.address),t.xp6(2),t.hij(" ",n.address," ")}}function q(e,a){1&e&&(t.TgZ(0,"th",36),t._uU(1," Ng\xe0y \u0111\u1eb7t "),t.qZA())}function J(e,a){if(1&e&&(t.TgZ(0,"td",37),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.hij(" ",n.dateScheduled," ")}}function H(e,a){1&e&&(t.TgZ(0,"th",36),t._uU(1," T/G \u0111\u1eb7t "),t.qZA())}function G(e,a){if(1&e&&(t.TgZ(0,"td",37),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.hij(" ",n.timeScheduled," ")}}function P(e,a){1&e&&(t.TgZ(0,"th",36),t._uU(1," Ph\u01b0\u01a1ng th\u1ee9c giao "),t.qZA())}function F(e,a){if(1&e&&(t.TgZ(0,"td",37),t._UZ(1,"i",41),t._uU(2),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.Q6J("ngClass",n.isScheduled?"fas fa-calendar":"fas fa-truck"),t.xp6(1),t.hij(" ",n.isScheduled?"H\u1eb9n tr\u01b0\u1edbc":"Giao ngay"," ")}}function $(e,a){1&e&&(t.TgZ(0,"th",36),t._uU(1," Thanh to\xe1n "),t.qZA())}function j(e,a){if(1&e&&(t.TgZ(0,"td",37),t._UZ(1,"i",42),t._uU(2),t.qZA()),2&e){const n=a.$implicit,o=t.oxw();t.xp6(1),t.Q6J("ngClass",o.getPaymentIcon(n.paymentMethod)),t.xp6(1),t.hij(" ",n.paymentMethod," ")}}function R(e,a){1&e&&(t.TgZ(0,"th",36),t._uU(1," Tr\u1ea1ng th\xe1i "),t.qZA())}function z(e,a){if(1&e&&(t.TgZ(0,"td",37)(1,"span",43),t._UZ(2,"i",42),t._uU(3),t.qZA()()),2&e){const n=a.$implicit,o=t.oxw();t.xp6(1),t.Q6J("ngClass",o.getStatusClass(n.status)),t.xp6(1),t.Q6J("ngClass",o.getStatusIcon(n.status)),t.xp6(1),t.hij(" ",o.getStatusTranslation(n.status)," ")}}function K(e,a){1&e&&(t.TgZ(0,"th",36),t._uU(1," T/G x\xe1c nh\u1eadn "),t.qZA())}function X(e,a){if(1&e&&(t.TgZ(0,"td",37),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.hij(" ",n.acceptedTime?n.acceptedTime:"Ch\u01b0a x\xe1c nh\u1eadn"," ")}}function W(e,a){1&e&&(t.TgZ(0,"th",36),t._uU(1," Ng\xe0y x\xe1c nh\u1eadn "),t.qZA())}function V(e,a){if(1&e&&(t.TgZ(0,"td",37),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.hij(" ",n.acceptedDate?n.acceptedDate:"Ch\u01b0a x\xe1c nh\u1eadn"," ")}}function tt(e,a){1&e&&(t.TgZ(0,"th",44),t._uU(1,"X\xe1c nh\u1eadn"),t.qZA())}function et(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"button",48),t.NdJ("click",function(){t.CHM(n);const r=t.oxw().$implicit,c=t.oxw();return t.KtG(c.acceptOrder(r))}),t.TgZ(1,"mat-icon"),t._uU(2,"done"),t.qZA()()}}function nt(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"button",49),t.NdJ("click",function(){t.CHM(n);const r=t.oxw().$implicit,c=t.oxw();return t.KtG(c.deliveringOrder(r))}),t.TgZ(1,"mat-icon"),t._uU(2,"local_shipping"),t.qZA()()}}function ot(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"button",50),t.NdJ("click",function(){t.CHM(n);const r=t.oxw().$implicit,c=t.oxw();return t.KtG(c.deniedOrder(r))}),t.TgZ(1,"mat-icon"),t._uU(2,"close"),t.qZA()()}}const at=function(){return["denied","completed"]};function it(e,a){if(1&e&&(t.TgZ(0,"td",37),t.YNc(1,et,3,0,"button",45),t.YNc(2,nt,3,0,"button",46),t.YNc(3,ot,3,0,"button",47),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.Q6J("ngIf","pending"===n.status.toLowerCase()),t.xp6(1),t.Q6J("ngIf","accepted"===n.status.toLowerCase()),t.xp6(1),t.Q6J("ngIf",!t.DdM(3,at).includes(n.status.toLowerCase()))}}function rt(e,a){1&e&&(t.TgZ(0,"th",51),t._uU(1,"Chi ti\u1ebft"),t.qZA())}function ct(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"td",52)(1,"button",53),t.NdJ("click",function(){const c=t.CHM(n).$implicit,d=t.oxw();return t.KtG(d.openOrderDetails(c))}),t.TgZ(2,"mat-icon"),t._uU(3,"visibility"),t.qZA()()()}}function st(e,a){1&e&&t._UZ(0,"tr",54)}function lt(e,a){1&e&&t._UZ(0,"tr",55)}const dt=function(){return[5,10,20,50]};let ut=(()=>{class e{constructor(n,o,r,c,d,Ot){this.orderService=n,this.authService=o,this._liveAnnouncer=r,this.dialog=c,this.snackbar=d,this.datePipe=Ot,this.displayedColumns=["key","name","phone","address","dateScheduled","timeScheduled","isScheduled","payment","status","acceptedTime","acceptedDate","accept","actions"],this.orders=[],this.isLoading=!1,this.filteredData=[],this.selectedStatus=""}ngOnInit(){this.getOrders()}getOrders(){this.isLoading=!0,this.authService.getCurrentUser().subscribe(n=>{this.orderService.getOrdersByShopId(n.shopId).subscribe(o=>{this.orderService.sortDataInReverse(o),this.dataSource=new l.by(o),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.isLoading=!1})})}openOrderDetails(n){this.dialog.open(O.o,{data:n})}openGoogleMapDialog(n){const o=`https://www.google.com/maps/embed/v1/place?key=AIzaSyDqDqn8Op87YfKOjIvWTNA1MpYmn3htW9M&q=${encodeURIComponent(n)}`;this.dialog.open(y,{data:{googleMapUrl:o}})}announceSortChange(n){this._liveAnnouncer.announce(n.direction?`Sorted ${n.direction}ending`:"Sorting cleared")}filterChange(n){this.applyFilter(n.target.value)}selectChange(n){this.selectedStatus=n.value,this.applyFilter(this.selectedStatus)}applyFilter(n=""){this.dataSource.filter=n}acceptOrder(n){n.status=s.q.ACCEPTED;const o=this.datePipe.transform(new Date,"HH:mm"),r=this.datePipe.transform(new Date,"dd/MM/yyyy");n.acceptedTime=o,n.acceptedDate=r,this.orderService.updateOrder(n.key,n).then(()=>{this.snackbar.openSnackBar("\u0110\xe3 x\xe1c nh\u1eadn \u0111\u01a1n h\xe0ng.")}).catch(c=>{console.error(c)})}deniedOrder(n){n.status=s.q.DENIED,this.orderService.updateOrder(n.key,n).then(()=>{this.snackbar.openSnackBar("\u0110\u01a1n h\xe0ng \u0111\xe3 b\u1ecb hu\u1ef7.","DONE")}).catch(o=>{console.error(o)})}deliveringOrder(n){n.status=s.q.DELIVERING,this.orderService.updateOrder(n.key,n).then(()=>{this.snackbar.openSnackBar("\u0110\u01a1n h\xe0ng \u0111\xe3 \u0111\u01b0\u1ee3c giao!","DONE")}).catch(o=>{console.error(o)})}getStatusClass(n){switch(n){case s.q.PENDING:return"text-info";case s.q.ACCEPTED:return"text-primary";case s.q.DENIED:return"text-danger";case s.q.DELIVERING:return"text-warning pulsating-text";case s.q.COMPLETED:return"text-green";default:return""}}getStatusIcon(n){switch(n){case s.q.PENDING:return"fa-hourglass-half rotating-icon";case s.q.ACCEPTED:return"fa-check-circle";case s.q.DENIED:return"fa-times-circle";case s.q.DELIVERING:return"fa-truck";case s.q.COMPLETED:return"fa-check";default:return""}}getPaymentIcon(n){switch(n){case h.CASH:return"fa-money-bill";case h.ONLINE:return"fa-credit-card";default:return""}}getStatusTranslation(n){return{pending:"Ch\u1edd x\xe1c nh\u1eadn",accepted:"\u0110\xe3 x\xe1c nh\u1eadn",denied:"\u0110\xe3 t\u1eeb ch\u1ed1i",delivering:"\u0110ang giao",completed:"\u0110\xe3 ho\xe0n th\xe0nh"}[n.toLowerCase()]||n}static#t=this.\u0275fac=function(o){return new(o||e)(t.Y36(v.p),t.Y36(A.e),t.Y36(N.Kd),t.Y36(f.uw),t.Y36(L.c),t.Y36(u.uU))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-list-order"]],viewQuery:function(o,r){if(1&o&&(t.Gf(p.NW,5),t.Gf(m.YE,5)),2&o){let c;t.iGM(c=t.CRH())&&(r.paginator=c.first),t.iGM(c=t.CRH())&&(r.sort=c.first)}},decls:65,vars:7,consts:[[1,"mt-4"],[1,"d-flex"],[1,"me-2"],["matInput","","placeholder","Nh\u1eadp d\u1eef li\u1ec7u c\u1ea7n t\xecm ...",3,"keyup"],[3,"selectionChange"],["value","pending"],["value","accepted"],["value","denied"],["value","delivering"],["value","completed"],[1,"table-responsive","mat-elevation-z8"],["mat-table","","matSort","",3,"dataSource","matSortChange"],["matColumnDef","key"],["mat-header-cell","","mat-sort-header","","class","fw-bold",4,"matHeaderCellDef"],["mat-cell","","class","text-truncate",4,"matCellDef"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","","class","fw-bold text-truncate",4,"matHeaderCellDef"],["matColumnDef","phone"],["matColumnDef","address"],["mat-cell","","class","text-truncate",3,"title",4,"matCellDef"],["matColumnDef","dateScheduled"],["matColumnDef","timeScheduled"],["matColumnDef","isScheduled"],["matColumnDef","payment"],["matColumnDef","status"],["matColumnDef","acceptedTime"],["matColumnDef","acceptedDate"],["matColumnDef","accept"],["mat-header-cell","","class","fw-bold",4,"matHeaderCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","fw-bold text-truncate",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","aria-label","Select page of periodic elements",3,"pageSize","pageSizeOptions"],[3,"isLoading"],["mat-header-cell","","mat-sort-header","",1,"fw-bold"],["mat-cell","",1,"text-truncate"],["mat-header-cell","","mat-sort-header","",1,"fw-bold","text-truncate"],["mat-cell","",1,"text-truncate",3,"title"],["href","javascript:",3,"click"],[1,"me-1",3,"ngClass"],[1,"me-1","fas",3,"ngClass"],[3,"ngClass"],["mat-header-cell","",1,"fw-bold"],["mat-icon-button","","color","primary","title","X\xe1c nh\u1eadn \u0111\u01a1n h\xe0ng",3,"click",4,"ngIf"],["mat-icon-button","","color","primary","title","Giao h\xe0ng",3,"click",4,"ngIf"],["mat-icon-button","","color","warn","title","Hu\u1ef7 \u0111\u01a1n h\xe0ng",3,"click",4,"ngIf"],["mat-icon-button","","color","primary","title","X\xe1c nh\u1eadn \u0111\u01a1n h\xe0ng",3,"click"],["mat-icon-button","","color","primary","title","Giao h\xe0ng",3,"click"],["mat-icon-button","","color","warn","title","Hu\u1ef7 \u0111\u01a1n h\xe0ng",3,"click"],["mat-header-cell","",1,"fw-bold","text-truncate"],["mat-cell",""],["mat-icon-button","","color","primary","title","Xem chi ti\u1ebft \u0111\u01a1n h\xe0ng",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(o,r){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"mat-form-field",2)(3,"input",3),t.NdJ("keyup",function(d){return r.filterChange(d)}),t.qZA()(),t.TgZ(4,"mat-form-field")(5,"mat-label"),t._uU(6,"Tr\u1ea1ng th\xe1i"),t.qZA(),t.TgZ(7,"mat-select",4),t.NdJ("selectionChange",function(d){return r.selectChange(d)}),t.TgZ(8,"mat-option"),t._uU(9,"-- None --"),t.qZA(),t.TgZ(10,"mat-option",5),t._uU(11,"Ch\u1edd x\xe1c nh\u1eadn"),t.qZA(),t.TgZ(12,"mat-option",6),t._uU(13,"\u0110\xe3 x\xe1c nh\u1eadn"),t.qZA(),t.TgZ(14,"mat-option",7),t._uU(15,"\u0110\xe3 t\u1eeb ch\u1ed1i"),t.qZA(),t.TgZ(16,"mat-option",8),t._uU(17,"\u0110ang giao"),t.qZA(),t.TgZ(18,"mat-option",9),t._uU(19,"\u0110\xe3 ho\xe0n th\xe0nh"),t.qZA()()()(),t.TgZ(20,"div",10)(21,"table",11),t.NdJ("matSortChange",function(d){return r.announceSortChange(d)}),t.ynx(22,12),t.YNc(23,Y,2,0,"th",13),t.YNc(24,B,2,1,"td",14),t.BQk(),t.ynx(25,15),t.YNc(26,I,2,0,"th",16),t.YNc(27,M,2,1,"td",14),t.BQk(),t.ynx(28,17),t.YNc(29,b,2,0,"th",13),t.YNc(30,k,2,1,"td",14),t.BQk(),t.ynx(31,18),t.YNc(32,w,2,0,"th",13),t.YNc(33,Q,3,2,"td",19),t.BQk(),t.ynx(34,20),t.YNc(35,q,2,0,"th",13),t.YNc(36,J,2,1,"td",14),t.BQk(),t.ynx(37,21),t.YNc(38,H,2,0,"th",13),t.YNc(39,G,2,1,"td",14),t.BQk(),t.ynx(40,22),t.YNc(41,P,2,0,"th",13),t.YNc(42,F,3,2,"td",14),t.BQk(),t.ynx(43,23),t.YNc(44,$,2,0,"th",13),t.YNc(45,j,3,2,"td",14),t.BQk(),t.ynx(46,24),t.YNc(47,R,2,0,"th",13),t.YNc(48,z,4,3,"td",14),t.BQk(),t.ynx(49,25),t.YNc(50,K,2,0,"th",13),t.YNc(51,X,2,1,"td",14),t.BQk(),t.ynx(52,26),t.YNc(53,W,2,0,"th",13),t.YNc(54,V,2,1,"td",14),t.BQk(),t.ynx(55,27),t.YNc(56,tt,2,0,"th",28),t.YNc(57,it,4,4,"td",14),t.BQk(),t.ynx(58,29),t.YNc(59,rt,2,0,"th",30),t.YNc(60,ct,4,0,"td",31),t.BQk(),t.YNc(61,st,1,0,"tr",32),t.YNc(62,lt,1,0,"tr",33),t.qZA()(),t._UZ(63,"mat-paginator",34)(64,"app-loading-dots",35),t.qZA()),2&o&&(t.xp6(21),t.Q6J("dataSource",r.dataSource),t.xp6(40),t.Q6J("matHeaderRowDef",r.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",r.displayedColumns),t.xp6(1),t.Q6J("pageSize",10)("pageSizeOptions",t.DdM(6,dt)),t.xp6(1),t.Q6J("isLoading",r.isLoading))},dependencies:[u.mk,u.O5,S.l,l.BZ,l.fO,l.as,l.w1,l.Dz,l.nj,l.ge,l.ev,l.XQ,l.Gk,p.NW,m.YE,m.nU,T.Hw,E.RK,g.KE,g.hX,x.gD,U.ey,Z.Nt],styles:[".text-green[_ngcontent-%COMP%]{color:green}@keyframes _ngcontent-%COMP%_pulse{0%{opacity:1}50%{opacity:.5}to{opacity:1}}.pulsating-text[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 1.5s infinite}@keyframes _ngcontent-%COMP%_rotate{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.rotating-icon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_rotate 2s linear infinite}"]})}return e})();const mt=[{path:"",component:(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-order"]],decls:1,vars:0,template:function(o,r){1&o&&t._UZ(0,"app-list-order")},dependencies:[ut]})}return e})()}];let pt=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275mod=t.oAB({type:e});static#n=this.\u0275inj=t.cJS({imports:[_.Bz.forChild(mt),_.Bz]})}return e})();var ht=i(8308),ft=i(5986),gt=i(6385),Ct=i(9038),_t=i(4104),Tt=i(5195),Et=i(5940),xt=i(9014);let Zt=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275mod=t.oAB({type:e});static#n=this.\u0275inj=t.cJS({providers:[u.uU],imports:[u.ez,pt,ht.m,l.p0,p.TU,m.JX,T.Ps,E.ot,g.lN,x.LD,Z.c,ft.p9,f.Is,gt.t,Ct.ie,_t.Nh,Tt.QW,Et.Cq,xt.g]})}return e})()}}]);
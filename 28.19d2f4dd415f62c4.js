"use strict";(self.webpackChunkmanage_shop=self.webpackChunkmanage_shop||[]).push([[28],{3028:(Zt,x,i)=>{i.r(x),i.d(x,{OrderModule:()=>xt});var m=i(6814),E=i(4190),t=i(5879),g=i(3365),p=i(3566),u=i(5313),D=i(5246),s=i(3373),f=function(e){return e.CASH="CASH",e.ONLINE="ONLINE",e}(f||{}),v=i(7329),d=i(7700),C=i(6223),_=i(2296),T=i(2032),h=i(4170);let y=(()=>{class e{constructor(n){this.data=n}static#t=this.\u0275fac=function(o){return new(o||e)(t.Y36(d.WI))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-input-dialog"]],decls:12,vars:4,consts:[["mat-dialog-title","",1,"f-poppins"],["mat-dialog-content","",1,"f-poppins"],["matInput","","placeholder","Nh\u1eadp d\u1eef li\u1ec7u ...",3,"ngModel","ngModelChange"],["mat-dialog-actions",""],["mat-button","","mat-dialog-close",""],["mat-button","","color","primary","cdkFocusInitial","",3,"mat-dialog-close"]],template:function(o,r){1&o&&(t.TgZ(0,"h1",0),t._uU(1),t.qZA(),t.TgZ(2,"div",1)(3,"p"),t._uU(4),t.qZA(),t.TgZ(5,"mat-form-field")(6,"input",2),t.NdJ("ngModelChange",function(l){return r.data.inputValue=l}),t.qZA()()(),t.TgZ(7,"div",3)(8,"button",4),t._uU(9,"Cancel"),t.qZA(),t.TgZ(10,"button",5),t._uU(11,"OK"),t.qZA()()),2&o&&(t.xp6(1),t.Oqu(r.data.title),t.xp6(3),t.Oqu(r.data.content),t.xp6(2),t.Q6J("ngModel",r.data.inputValue),t.xp6(4),t.Q6J("mat-dialog-close",r.data.inputValue))},dependencies:[C.Fj,C.JJ,C.On,d.ZT,d.uh,d.xY,d.H8,_.lW,T.Nt,h.KE],styles:[".f-poppins[_ngcontent-%COMP%]{font-family:Poppins,sans-serif}"]})}return e})();var A=i(3601),N=i(4630),L=i(4191),U=i(2425),S=i(4321),Z=i(1175),O=i(8525),I=i(3680);function Y(e,a){1&e&&(t.TgZ(0,"th",34),t._uU(1," M\xe3 "),t.qZA())}function M(e,a){if(1&e&&(t.TgZ(0,"td",35),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.hij(" ",n.key," ")}}function b(e,a){1&e&&(t.TgZ(0,"th",36),t._uU(1," Kh\xe1ch h\xe0ng "),t.qZA())}function Q(e,a){if(1&e&&(t.TgZ(0,"td",35),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.hij(" ",n.name," ")}}function q(e,a){1&e&&(t.TgZ(0,"th",34),t._uU(1," S\u0110T "),t.qZA())}function J(e,a){if(1&e&&(t.TgZ(0,"td",35),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.hij(" ",n.phoneNumber," ")}}function B(e,a){1&e&&(t.TgZ(0,"th",34),t._uU(1," \u0110\u1ecba ch\u1ec9 "),t.qZA())}function w(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"td",37)(1,"a",38),t.NdJ("click",function(){const c=t.CHM(n).$implicit,l=t.oxw();return t.KtG(l.openGoogleMapDialog(c.address))}),t._uU(2),t.qZA()()}if(2&e){const n=a.$implicit;t.s9C("title",n.address),t.xp6(2),t.hij(" ",n.address," ")}}function H(e,a){1&e&&(t.TgZ(0,"th",34),t._uU(1," Ph\u01b0\u01a1ng th\u1ee9c giao "),t.qZA())}function k(e,a){if(1&e&&(t.TgZ(0,"td",35),t._UZ(1,"i",39),t._uU(2),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.Q6J("ngClass",n.isScheduled?"fas fa-calendar":"fas fa-truck"),t.xp6(1),t.hij(" ",n.isScheduled?"H\u1eb9n tr\u01b0\u1edbc":"Giao ngay"," ")}}function F(e,a){1&e&&(t.TgZ(0,"th",34),t._uU(1," Thanh to\xe1n "),t.qZA())}function P(e,a){if(1&e&&(t.TgZ(0,"td",35),t._UZ(1,"i",40),t._uU(2),t.qZA()),2&e){const n=a.$implicit,o=t.oxw();t.xp6(1),t.Q6J("ngClass",o.getPaymentIcon(n.paymentMethod)),t.xp6(1),t.hij(" ",n.paymentMethod," ")}}function G(e,a){1&e&&(t.TgZ(0,"th",34),t._uU(1," Tr\u1ea1ng th\xe1i "),t.qZA())}function R(e,a){if(1&e&&(t.TgZ(0,"p",43),t._uU(1),t.qZA()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.hij(" L\xfd do: ",n.cancellationReason," ")}}function $(e,a){if(1&e&&(t.TgZ(0,"td",35)(1,"span",41),t._UZ(2,"i",40),t._uU(3),t.YNc(4,R,2,1,"p",42),t.qZA()()),2&e){const n=a.$implicit,o=t.oxw();t.xp6(1),t.Q6J("ngClass",o.getStatusClass(n.status)),t.xp6(1),t.Q6J("ngClass",o.getStatusIcon(n.status)),t.xp6(1),t.hij(" ",o.getStatusTranslation(n.status)," "),t.xp6(1),t.Q6J("ngIf","denied"===n.status.toLowerCase())}}function j(e,a){1&e&&(t.TgZ(0,"th",34),t._uU(1," T/G x\xe1c nh\u1eadn "),t.qZA())}function z(e,a){if(1&e&&(t.TgZ(0,"td",35),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.hij(" ",n.acceptedTime?n.acceptedTime:"Ch\u01b0a x\xe1c nh\u1eadn"," ")}}function K(e,a){1&e&&(t.TgZ(0,"th",34),t._uU(1," Ng\xe0y x\xe1c nh\u1eadn "),t.qZA())}function X(e,a){if(1&e&&(t.TgZ(0,"td",35),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.hij(" ",n.acceptedDate?n.acceptedDate:"Ch\u01b0a x\xe1c nh\u1eadn"," ")}}function V(e,a){1&e&&(t.TgZ(0,"th",44),t._uU(1,"X\xe1c nh\u1eadn"),t.qZA())}function W(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"button",48),t.NdJ("click",function(){t.CHM(n);const r=t.oxw().$implicit,c=t.oxw();return t.KtG(c.acceptOrder(r))}),t.TgZ(1,"mat-icon"),t._uU(2,"done"),t.qZA()()}}function tt(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"button",49),t.NdJ("click",function(){t.CHM(n);const r=t.oxw().$implicit,c=t.oxw();return t.KtG(c.deliveringOrder(r))}),t.TgZ(1,"mat-icon"),t._uU(2,"local_shipping"),t.qZA()()}}function et(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"button",50),t.NdJ("click",function(){t.CHM(n);const r=t.oxw().$implicit,c=t.oxw();return t.KtG(c.deniedOrder(r))}),t.TgZ(1,"mat-icon"),t._uU(2,"close"),t.qZA()()}}const nt=function(){return["denied","completed"]};function ot(e,a){if(1&e&&(t.TgZ(0,"td",35),t.YNc(1,W,3,0,"button",45),t.YNc(2,tt,3,0,"button",46),t.YNc(3,et,3,0,"button",47),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.Q6J("ngIf","pending"===n.status.toLowerCase()),t.xp6(1),t.Q6J("ngIf","accepted"===n.status.toLowerCase()),t.xp6(1),t.Q6J("ngIf",!t.DdM(3,nt).includes(n.status.toLowerCase()))}}function at(e,a){1&e&&(t.TgZ(0,"th",51),t._uU(1,"Chi ti\u1ebft"),t.qZA())}function it(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"td",52)(1,"button",53),t.NdJ("click",function(){const c=t.CHM(n).$implicit,l=t.oxw();return t.KtG(l.openOrderDetails(c))}),t.TgZ(2,"mat-icon"),t._uU(3,"visibility"),t.qZA()()()}}function rt(e,a){1&e&&t._UZ(0,"tr",54)}function ct(e,a){1&e&&t._UZ(0,"tr",55)}const st=function(){return[5,10,20,50]};let lt=(()=>{class e{constructor(n,o,r,c,l,Et){this.orderService=n,this.authService=o,this._liveAnnouncer=r,this.dialog=c,this.datePipe=l,this.toastr=Et,this.displayedColumns=["key","name","phone","address","isScheduled","payment","status","acceptedTime","acceptedDate","accept","actions"],this.orders=[],this.isLoading=!1,this.filteredData=[],this.selectedStatus=""}ngOnInit(){this.getOrders()}getOrders(){this.isLoading=!0,this.authService.getCurrentUser().subscribe(n=>{this.orderService.getOrdersByShopId(n.shopId).subscribe(o=>{this.orderService.sortDataInReverse(o),this.dataSource=new u.by(o),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.isLoading=!1})})}openOrderDetails(n){this.dialog.open(D.o,{data:n})}openGoogleMapDialog(n){const o=`https://www.google.com/maps/embed/v1/place?key=AIzaSyDqDqn8Op87YfKOjIvWTNA1MpYmn3htW9M&q=${encodeURIComponent(n)}`;this.dialog.open(v.k,{data:{googleMapUrl:o}})}announceSortChange(n){this._liveAnnouncer.announce(n.direction?`Sorted ${n.direction}ending`:"Sorting cleared")}filterChange(n){this.applyFilter(n.target.value)}selectChange(n){this.selectedStatus=n.value,this.applyFilter(this.selectedStatus)}applyFilter(n=""){this.dataSource.filter=n}acceptOrder(n){n.status=s.q.ACCEPTED;const o=this.datePipe.transform(new Date,"HH:mm"),r=this.datePipe.transform(new Date,"dd/MM/yyyy");n.acceptedTime=o,n.acceptedDate=r,this.orderService.updateOrder(n.key,n).then(()=>{this.toastr.success("\u0110\xe3 x\xe1c nh\u1eadn \u0111\u01a1n h\xe0ng.","Th\xe0nh c\xf4ng!")}).catch(c=>{console.error(c)})}deniedOrder(n){this.dialog.open(y,{data:{title:"Hu\u1ef7 \u0111\u01a1n h\xe0ng?",content:"Vui l\xf2ng nh\u1eadp l\xfd do hu\u1ef7 \u0111\u01a1n h\xe0ng!",inputValue:""}}).afterClosed().subscribe(r=>{r&&(n.status=s.q.DENIED,n.cancellationReason=r,this.orderService.updateOrder(n.key,n).then(()=>{this.toastr.error("\u0110\u01a1n h\xe0ng \u0111\xe3 b\u1ecb hu\u1ef7.","\u0110\xe3 hu\u1ef7!")}).catch(c=>{console.error(c)}))})}deliveringOrder(n){n.status=s.q.DELIVERING,this.orderService.updateOrder(n.key,n).then(()=>{this.toastr.success("\u0110\u01a1n h\xe0ng \u0111\xe3 \u0111\u01b0\u1ee3c giao.","Th\xe0nh c\xf4ng!")}).catch(o=>{console.error(o)})}getStatusClass(n){switch(n){case s.q.PENDING:return"text-info";case s.q.ACCEPTED:return"text-primary";case s.q.DENIED:return"text-danger";case s.q.DELIVERING:return"text-warning pulsating-text";case s.q.COMPLETED:return"text-green";default:return""}}getStatusIcon(n){switch(n){case s.q.PENDING:return"fa-hourglass-half rotating-icon";case s.q.ACCEPTED:return"fa-check-circle";case s.q.DENIED:return"fa-times-circle";case s.q.DELIVERING:return"fa-truck";case s.q.COMPLETED:return"fa-check";default:return""}}getPaymentIcon(n){switch(n){case f.CASH:return"fa-money-bill";case f.ONLINE:return"fa-credit-card";default:return""}}getStatusTranslation(n){return{pending:"Ch\u1edd x\xe1c nh\u1eadn",accepted:"\u0110\xe3 x\xe1c nh\u1eadn",denied:"\u0110\xe3 t\u1eeb ch\u1ed1i",delivering:"\u0110ang giao",completed:"\u0110\xe3 ho\xe0n th\xe0nh"}[n.toLowerCase()]||n}static#t=this.\u0275fac=function(o){return new(o||e)(t.Y36(A.p),t.Y36(N.e),t.Y36(L.Kd),t.Y36(d.uw),t.Y36(m.uU),t.Y36(U._W))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-list-order"]],viewQuery:function(o,r){if(1&o&&(t.Gf(g.NW,5),t.Gf(p.YE,5)),2&o){let c;t.iGM(c=t.CRH())&&(r.paginator=c.first),t.iGM(c=t.CRH())&&(r.sort=c.first)}},decls:59,vars:7,consts:[[1,"mt-4"],[1,"d-flex"],[1,"me-2"],["matInput","","placeholder","Nh\u1eadp d\u1eef li\u1ec7u c\u1ea7n t\xecm ...",3,"keyup"],[3,"selectionChange"],["value","pending"],["value","accepted"],["value","denied"],["value","delivering"],["value","completed"],[1,"table-responsive","mat-elevation-z8"],["mat-table","","matSort","",3,"dataSource","matSortChange"],["matColumnDef","key"],["mat-header-cell","","mat-sort-header","","class","fw-bold",4,"matHeaderCellDef"],["mat-cell","","class","text-truncate",4,"matCellDef"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","","class","fw-bold text-truncate",4,"matHeaderCellDef"],["matColumnDef","phone"],["matColumnDef","address"],["mat-cell","","class","text-truncate",3,"title",4,"matCellDef"],["matColumnDef","isScheduled"],["matColumnDef","payment"],["matColumnDef","status"],["matColumnDef","acceptedTime"],["matColumnDef","acceptedDate"],["matColumnDef","accept"],["mat-header-cell","","class","fw-bold",4,"matHeaderCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","fw-bold text-truncate",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","aria-label","Select page of periodic elements",3,"pageSize","pageSizeOptions"],[3,"isLoading"],["mat-header-cell","","mat-sort-header","",1,"fw-bold"],["mat-cell","",1,"text-truncate"],["mat-header-cell","","mat-sort-header","",1,"fw-bold","text-truncate"],["mat-cell","",1,"text-truncate",3,"title"],["href","javascript:",3,"click"],[1,"me-1",3,"ngClass"],[1,"me-1","fas",3,"ngClass"],[3,"ngClass"],["class","text-center text-info m-0","style","font-size: 10px; font-style: italic;",4,"ngIf"],[1,"text-center","text-info","m-0",2,"font-size","10px","font-style","italic"],["mat-header-cell","",1,"fw-bold"],["mat-icon-button","","color","primary","title","X\xe1c nh\u1eadn \u0111\u01a1n h\xe0ng",3,"click",4,"ngIf"],["mat-icon-button","","color","primary","title","Giao h\xe0ng",3,"click",4,"ngIf"],["mat-icon-button","","color","warn","title","Hu\u1ef7 \u0111\u01a1n h\xe0ng",3,"click",4,"ngIf"],["mat-icon-button","","color","primary","title","X\xe1c nh\u1eadn \u0111\u01a1n h\xe0ng",3,"click"],["mat-icon-button","","color","primary","title","Giao h\xe0ng",3,"click"],["mat-icon-button","","color","warn","title","Hu\u1ef7 \u0111\u01a1n h\xe0ng",3,"click"],["mat-header-cell","",1,"fw-bold","text-truncate"],["mat-cell",""],["mat-icon-button","","color","primary","title","Xem chi ti\u1ebft \u0111\u01a1n h\xe0ng",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(o,r){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"mat-form-field",2)(3,"input",3),t.NdJ("keyup",function(l){return r.filterChange(l)}),t.qZA()(),t.TgZ(4,"mat-form-field")(5,"mat-label"),t._uU(6,"Tr\u1ea1ng th\xe1i"),t.qZA(),t.TgZ(7,"mat-select",4),t.NdJ("selectionChange",function(l){return r.selectChange(l)}),t.TgZ(8,"mat-option"),t._uU(9,"-- None --"),t.qZA(),t.TgZ(10,"mat-option",5),t._uU(11,"Ch\u1edd x\xe1c nh\u1eadn"),t.qZA(),t.TgZ(12,"mat-option",6),t._uU(13,"\u0110\xe3 x\xe1c nh\u1eadn"),t.qZA(),t.TgZ(14,"mat-option",7),t._uU(15,"\u0110\xe3 t\u1eeb ch\u1ed1i"),t.qZA(),t.TgZ(16,"mat-option",8),t._uU(17,"\u0110ang giao"),t.qZA(),t.TgZ(18,"mat-option",9),t._uU(19,"\u0110\xe3 ho\xe0n th\xe0nh"),t.qZA()()()(),t.TgZ(20,"div",10)(21,"table",11),t.NdJ("matSortChange",function(l){return r.announceSortChange(l)}),t.ynx(22,12),t.YNc(23,Y,2,0,"th",13),t.YNc(24,M,2,1,"td",14),t.BQk(),t.ynx(25,15),t.YNc(26,b,2,0,"th",16),t.YNc(27,Q,2,1,"td",14),t.BQk(),t.ynx(28,17),t.YNc(29,q,2,0,"th",13),t.YNc(30,J,2,1,"td",14),t.BQk(),t.ynx(31,18),t.YNc(32,B,2,0,"th",13),t.YNc(33,w,3,2,"td",19),t.BQk(),t.ynx(34,20),t.YNc(35,H,2,0,"th",13),t.YNc(36,k,3,2,"td",14),t.BQk(),t.ynx(37,21),t.YNc(38,F,2,0,"th",13),t.YNc(39,P,3,2,"td",14),t.BQk(),t.ynx(40,22),t.YNc(41,G,2,0,"th",13),t.YNc(42,$,5,4,"td",14),t.BQk(),t.ynx(43,23),t.YNc(44,j,2,0,"th",13),t.YNc(45,z,2,1,"td",14),t.BQk(),t.ynx(46,24),t.YNc(47,K,2,0,"th",13),t.YNc(48,X,2,1,"td",14),t.BQk(),t.ynx(49,25),t.YNc(50,V,2,0,"th",26),t.YNc(51,ot,4,4,"td",14),t.BQk(),t.ynx(52,27),t.YNc(53,at,2,0,"th",28),t.YNc(54,it,4,0,"td",29),t.BQk(),t.YNc(55,rt,1,0,"tr",30),t.YNc(56,ct,1,0,"tr",31),t.qZA()(),t._UZ(57,"mat-paginator",32)(58,"app-loading-dots",33),t.qZA()),2&o&&(t.xp6(21),t.Q6J("dataSource",r.dataSource),t.xp6(34),t.Q6J("matHeaderRowDef",r.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",r.displayedColumns),t.xp6(1),t.Q6J("pageSize",10)("pageSizeOptions",t.DdM(6,st)),t.xp6(1),t.Q6J("isLoading",r.isLoading))},dependencies:[m.mk,m.O5,S.l,u.BZ,u.fO,u.as,u.w1,u.Dz,u.nj,u.ge,u.ev,u.XQ,u.Gk,g.NW,p.YE,p.nU,Z.Hw,_.RK,h.KE,h.hX,O.gD,I.ey,T.Nt],styles:[".text-green[_ngcontent-%COMP%]{color:green}@keyframes _ngcontent-%COMP%_pulse{0%{opacity:1}50%{opacity:.5}to{opacity:1}}.pulsating-text[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 1.5s infinite}@keyframes _ngcontent-%COMP%_rotate{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.rotating-icon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_rotate 2s linear infinite}"]})}return e})();const ut=[{path:"",component:(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-order"]],decls:1,vars:0,template:function(o,r){1&o&&t._UZ(0,"app-list-order")},dependencies:[lt]})}return e})()}];let dt=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275mod=t.oAB({type:e});static#n=this.\u0275inj=t.cJS({imports:[E.Bz.forChild(ut),E.Bz]})}return e})();var mt=i(8308),pt=i(5986),ht=i(6385),gt=i(9038),ft=i(4104),Ct=i(5195),_t=i(5940),Tt=i(9014);let xt=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275mod=t.oAB({type:e});static#n=this.\u0275inj=t.cJS({providers:[m.uU],imports:[m.ez,dt,mt.m,u.p0,g.TU,p.JX,Z.Ps,_.ot,h.lN,O.LD,T.c,pt.p9,d.Is,ht.t,gt.ie,ft.Nh,Ct.QW,_t.Cq,Tt.g]})}return e})()}}]);